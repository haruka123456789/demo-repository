<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>A-Frame Selectable Object with jQuery</title>

  <!-- スタートボタンのCSS -->
  <style>
    #startButton {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 10px 20px;
      font-size: 16px;
      z-index: 1000; /* スタートボタンが他の要素の上に表示されるように */
    }
  </style>

  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
</head>

<body>
  <!-- スタートボタン追加 -->
  <button id="startButton">スタート</button> 

  <!-- BGM追加 -->
  <audio id="bgm" src="Daily_Stroll.mp3"loop></audio>

  <!-- 効果音追加 --> 
  <audio id="clickSound" src="hiton.mp3"></audio> 

  <a-scene cursor="rayOrigin: mouse">

    <!-- 追加 -->
  <a-entity id="ctlR" laser-controls="hand: right" raycaster="lineColor: red;"></a-entity>
  
   <!-- 背景の設定 -->
    <a-light
        type="directional"
        intensity="1.0"
        position="10 100 30"
      ></a-light>
      <a-light type="ambient" intensity="0.2" color="#404040"></a-light>
      <a-sky src="yakei_360.jpg" rotation="0 180 0"></a-sky>

    <!-- 赤い箱 -->
     <!-- xyz -->
     <a-box
     id="box1"
     position="0 1 -3"
     color="red"
     animation="property:position; from:0 1 -3; to:0 1 -8;  dur:2500; dir:alternate; loop:true; easing:linear;"
     ></a-box>
    
     <!-- 青い箱 -->
     <a-box
     id="box2"
     position="3 3 -3"
     color="blue"
     animation="property:position; from:3 3 -3; to:3 5 -10;  dur:1500; dir:alternate; loop:true; easing:linear;"
     ></a-box>

     <!-- 黄色い箱 -->
     <a-box
     id="box3"
     position="-3 8 -8"
     color="yellow"
     animation="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;"
     ></a-box>

     <!-- 緑の箱 -->
     <a-box
     id="box4"
     position="-4 5 -5"
     color="#228b22"
     animation="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;"
     ></a-box>

     <!-- 紫の箱 -->
     <a-box
     id="box5"
     position="-5 1 -5"
     color="#ba55d3"
     animation="property:position; from:-5 1 -3; to:-5 8 -3;  dur:2500; dir:alternate; loop:true; easing:linear;"
     ></a-box>

      <!-- 水色の箱 -->
      <a-box
      id="box6"
      position="5 6 -6"
      color="#00bfff"
      animation="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;"
      ></a-box>

       <!-- ベージュの箱 -->
     <a-box
     id="box7"
     position="-5 2 -10"
     color="#ffdab9"
     animation="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;"
     ></a-box>

     <!-- ピンクの箱 -->
     <a-box
     id="box8"
     position="4 10 -10"
     color="#ff69b4"
     animation="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;"
     ></a-box>

     <!-- 薄黄色の箱 -->
     <a-box
     id="box9"
     position="4 10 -10"
     color="#ffffe0"
     animation="property:position; from:10 12 -10; to:-10 12 -10;  dur:2300; dir:alternate; loop:true; easing:linear;"
     ></a-box>

     <!-- オレンジの箱 -->
     <a-box
     id="box10"
     position="6 6 -6"
     color="#ff8c00"
     animation="property:position; from:6 6 -6; to:-10 10 -10;  dur:2300; dir:alternate; loop:true; easing:linear;"
     ></a-box>


     <!-- ポイントのテキスト表示 -->
     <a-text
     id="txt"
     value=""
     position="0 2.7 -2"
     scale="2 2 2"
     align="center"
     color="#AA00FF"
    ></a-text>


  </a-scene>

  <script>
    const txt = document.getElementById("txt");

    // カウント変数
    let get_point = 0; // 獲得ポイント
    
    // テキストを更新する関数
    function updateText() { 
      txt.setAttribute('value', `point: ${get_point}`);      
    }

    // クリックでオブジェクトを削除する
    ['#box1', '#box2', '#box3','#box4', '#box5',
     '#box6','#box7', '#box8', '#box9','#box10'].forEach(id => {
      $(id).on('click', function(e) {
        this.remove();
        get_point++;
        clickSound.play();
        updateText(); // テキストを更新
      });
    });

    //コントローラでオブジェクトを消去する
    ['#box1', '#box2', '#box3','#box4', '#box5',
     '#box6','#box7', '#box8', '#box9','#box10'].forEach(id => {
      $(id).on('triggerdown', function(e) {
        this.remove();
        get_point++;
        clickSound.play();
        updateText(); // テキストを更新
      });
    });

    // 初期テキスト設定 
    updateText();

    // スタートボタンのクリックイベントを設定
    $('#startButton').on('click', function() {
      const settings = [
        { id: '#box1', anim: 'property:position; from:0 1 -3; to:0 1 -8; dur:2500; dir:alternate; loop:true; easing:linear;' },
        { id: '#box2', anim: 'property:position; from:3 3 -3; to:3 5 -10; dur:1500; dir:alternate; loop:true; easing:linear;' },
        { id: '#box3', anim: 'property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;' },
        { id: '#box4', anim: 'property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;' },
        { id: '#box5', anim: 'property:position; from:-5 1 -3; to:-5 8 -3;  dur:2500; dir:alternate; loop:true; easing:linear;' },
        { id: '#box6', anim: 'property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;' },
        { id: '#box7', anim: 'property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;' },
        { id: '#box8', anim: 'property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear;' },
        { id: '#box9', anim: 'property:position; from:10 12 -10; to:-10 12 -10;  dur:2300; dir:alternate; loop:true; easing:linear;' },
        { id: '#box10', anim: 'property:position; from:6 6 -6; to:-10 10 -10;  dur:2300;' }
      ];

      settings.forEach(box => {
        $(box.id).attr('animation', box.anim).attr('visible', 'true');
      });

      // スタートボタンを消す
      $('#startButton').hide();

      // BGMを再生する
      document.getElementById('bgm').play();
    });
  </script>
</body>
</html>
